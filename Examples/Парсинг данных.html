<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0029)http://blog.epicsoft.ru/?p=34 -->
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru-RU"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>   Парсинг данных | Блог | Epic Soft</title>

<meta name="description" content="Блог о программировании">
<meta name="generator" content="WordPress 3.4.1"> <!-- leave this for stats please -->
<link href="./Парсинг данных_files/style.css" rel="stylesheet" type="text/css" media="screen">
<link rel="alternate" type="application/rss+xml" title="Блог | Epic Soft RSS Feed" href="http://blog.epicsoft.ru/?feed=rss2">
<link rel="shortcut icon" href="http://blog.epicsoft.ru/wp-content/themes/epicsoft/favicon.ico">
<link rel="pingback" href="http://blog.epicsoft.ru/xmlrpc.php">
<script type="text/javascript" src="./Парсинг данных_files/jquery-1.7.1.min.js"></script>
<link rel="alternate" type="application/rss+xml" title="Блог | Epic Soft » Лента комментариев к «Парсинг данных»" href="http://blog.epicsoft.ru/?feed=rss2&p=34">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://blog.epicsoft.ru/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://blog.epicsoft.ru/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Работа с многопоточностью на xNet" href="http://blog.epicsoft.ru/?p=26">
<link rel="next" title="Работа с Вконтакте API" href="http://blog.epicsoft.ru/?p=49">
<meta name="generator" content="WordPress 3.4.1">
<link rel="canonical" href="./Парсинг данных_files/Парсинг данных.html">
	<link type="text/css" rel="stylesheet" href="./Парсинг данных_files/shCore.css">
	<link type="text/css" rel="stylesheet" href="./Парсинг данных_files/shThemeDefault.css">
<script type="text/javascript" src="chrome-extension://nhgcieglcpdegkhamigiokdphfhhnlhh/js/injected.js" charset="utf-8"></script></head>

<body>
    <!--main-->
    <div id="main">
        <!--header-wrap-->
        <div id="header-wrap">
            <!--logo-->
            <div id="logo">
                <p>
                    <a href="http://blog.epicsoft.ru/"><span class="first-letter">E</span>pic<span class="first-letter">S</span>oft</a></p>
            </div>
            <!--/logo-->
        </div>
        <!--/header-wrap-->
<div id="content">

<h2 id="post-34">Парсинг данных</h2>
<div class="link-comment-count"><a href="http://blog.epicsoft.ru/?p=34#comments">К комментариям</a></div>

<div class="main">
	<p>В данной статье будут рассмотрены способы парсинга данных, в частности <em>HTML</em>. Я рекомендую использовать способы в том порядке, в котором они указаны в статье, в зависимости от задачи. Статья ориентирована на программистов, знающих основы <em>HTML</em>. В конце статьи указаны ссылки на материалы по теме.</p>
<p><strong>1. Извлечение подстроки</strong></p>
<p>Самый простой способ, это извлечь подстроку начиная c заданной позиции в строке, но мы пойдём чуть дальше и используем расширяющие методы библиотеки <em>xNet</em>. Они позволяют извлечь подстроку, которая находится между двумя заданными подстроками. Например, у нас есть строка «dfmvcx{d}data{/d}fdfgf», нам нужно извлечь из неё подстроку «data». Мы видим, что она находится между «{d}» и «{/d}», поэтому мы можем её спокойно извлечь написав следующий код:</p>
<div class="syntaxhighlighter " id="highlighter_504569" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">1.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code> <code class="plain">str = </code><code class="string">"dfmvcx{d}data{/d}fdfgf"</code><code class="plain">;</code></span></span></div><div class="line alt2"><code class="number">2.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code> <code class="plain">result = str.Substring(</code><code class="string">"{d}"</code><code class="plain">, </code><code class="string">"{/d}"</code><code class="plain">);</code></span></span></div><div class="line alt1"><code class="number">3.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt2"><code class="number">4.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">Console.WriteLine(result); </code><code class="comments">// data</code></span></span></div></div></div>
<p><span id="more-34"></span></p>
<p>Давайте рассмотрим другой пример. Нам нужно получить значение элемента некой формы на <em>HTML</em>-странице:</p>
<div class="syntaxhighlighter " id="highlighter_648270" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">1.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">&lt;</code><code class="keyword">form</code> <code class="color1">method</code><code class="plain">=</code><code class="string">"post"</code> <code class="color1">action</code><code class="plain">=</code><code class="string">"<a href="http://pentagon.osd.mil/login">http://pentagon.osd.mil/login</a>"</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">2.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">&lt;</code><code class="keyword">input</code> <code class="color1">type</code><code class="plain">=</code><code class="string">"text"</code> <code class="color1">name</code><code class="plain">=</code><code class="string">"login"</code> <code class="plain">/&gt;</code></span></span></div><div class="line alt1"><code class="number">3.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">&lt;</code><code class="keyword">input</code> <code class="color1">type</code><code class="plain">=</code><code class="string">"text"</code> <code class="color1">name</code><code class="plain">=</code><code class="string">"password"</code> <code class="plain">/&gt;</code></span></span></div><div class="line alt2"><code class="number">4.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">&lt;</code><code class="keyword">input</code> <code class="color1">type</code><code class="plain">=</code><code class="string">"hidden"</code> <code class="color1">name</code><code class="plain">=</code><code class="string">"securitytoken"</code> <code class="color1">value</code><code class="plain">=</code><code class="string">"9061861"</code> <code class="plain">/&gt;</code></span></span></div><div class="line alt1"><code class="number">5.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">&lt;</code><code class="keyword">input</code> <code class="color1">type</code><code class="plain">=</code><code class="string">"submit"</code> <code class="color1">value</code><code class="plain">=</code><code class="string">"I'm here"</code> <code class="plain">/&gt;</code></span></span></div><div class="line alt2"><code class="number">6.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">&lt;/</code><code class="keyword">form</code><code class="plain">&gt;</code></span></span></div></div></div>
<p>А теперь код:</p>
<div class="syntaxhighlighter " id="highlighter_877309" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">1.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code> <code class="plain">str = </code><code class="string">"..."</code><code class="plain">;</code></span></span></div><div class="line alt2"><code class="number">2.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code> <code class="plain">result = str.Substring(</code><code class="string">"name=\"securitytoken\" value=\""</code><code class="plain">, </code><code class="string">"\""</code><code class="plain">);</code></span></span></div><div class="line alt1"><code class="number">3.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt2"><code class="number">4.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">Console.WriteLine(result); </code><code class="comments">// 9061861</code></span></span></div></div></div>
<p>Как видите, всё очень просто. Но прежде нужно проверить, то ли вы спарсите, так как указанная вами подстрока может неоднократно дублироваться на странице.</p>
<p>Выделяем подстроку, начиная с заданной подстроки и до конца строки:</p>
<div class="syntaxhighlighter " id="highlighter_199088" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">1.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code> <code class="plain">str = </code><code class="string">"param1=value&amp;amp;param2=value&amp;amp;hash=123"</code><code class="plain">;</code></span></span></div><div class="line alt2"><code class="number">2.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code> <code class="plain">result = str.Substring(</code><code class="string">"hash="</code><code class="plain">);</code></span></span></div><div class="line alt1"><code class="number">3.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt2"><code class="number">4.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">Console.WriteLine(result); </code><code class="comments">// 123</code></span></span></div></div></div>
<p>Выделяем последнею подстроку:</p>
<div class="syntaxhighlighter " id="highlighter_874470" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">1.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code> <code class="plain">str = </code><code class="string">"fkvv{x}1{/x}dfdsfs{x}2{/x}dff,df{x}3{/x}"</code><code class="plain">;</code></span></span></div><div class="line alt2"><code class="number">2.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code> <code class="plain">result = str.LastSubstring(</code><code class="string">"{x}"</code><code class="plain">, </code><code class="string">"{/x}"</code><code class="plain">);</code></span></span></div><div class="line alt1"><code class="number">3.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt2"><code class="number">4.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">Console.WriteLine(result); </code><code class="comments">// 3</code></span></span></div></div></div>
<p>Выделяем все подстроки:</p>
<div class="syntaxhighlighter " id="highlighter_445815" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">1.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code> <code class="plain">str = </code><code class="string">"fkvv{x}1{/x}dfdsfs{x}2{/x}dff,df{x}3{/x}"</code><code class="plain">;</code></span></span></div><div class="line alt2"><code class="number">2.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code><code class="plain">[] result = str.Substrings(</code><code class="string">"{x}"</code><code class="plain">, </code><code class="string">"{/x}"</code><code class="plain">);</code></span></span></div><div class="line alt1"><code class="number">3.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt2"><code class="number">4.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">foreach</code> <code class="plain">(var substring </code><code class="keyword">in</code> <code class="plain">result)</code></span></span></div><div class="line alt1"><code class="number">5.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">{</code></span></span></div><div class="line alt2"><code class="number">6.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">Console.Write(substring + </code><code class="string">" "</code><code class="plain">); </code><code class="comments">// 1 2 3</code></span></span></div><div class="line alt1"><code class="number">7.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">}</code></span></span></div></div></div>
<p><strong>2. Регулярные выражения</strong></p>
<p>Это не те регулярные выражения, которыми мы обычно называем других людей, а те, которые позволяют извлекать данные с помощью специальных шаблонов, в которых можно прописать множество условий. Мы можем указать, что первая часть строки должна состоять только из цифр, дальше должен следовать определённый символ, потом может следовать строка из 10 символов, либо вообще ничего. Про них уже написаны сотни статей. Вот весьма хорошая статья на <a href="http://msdn.microsoft.com/ru-ru/library/hs600312.aspx" title="Регулярные выражения" target="_blank">MSDN</a>.</p>
<p>Предположим, что нам нужно спарсить все e-mail адреса. E-mail адрес имеет вид <em>имя_пользователя@имя_домена</em>. Теперь давайте на основе этих данных составим простой шаблон:</p>
<ul>
<li>имя_пользователя — [a-z0-9_-.]{1,20}. Имя пользователя может содержать только определённый набор символов, который указан в квадратных скобках, и иметь длину от 1 до 20 символов.</li>
<li>@</li>
<li>имя_домена — [a-z0-9_-]{1,20}.[a-z]{2,4}. До точки мы проверяем домен второго уровня (например mail), после точки домен первого уровня (например ru).</li>
</ul>
<p>А теперь реализуем поиск e-mail’s в коде:</p>
<div class="syntaxhighlighter " id="highlighter_414442" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">1.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">string</code> <code class="plain">content = </code><code class="string">"..."</code><code class="plain">;</code></span></span></div><div class="line alt2"><code class="number">2.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">var regex = </code><code class="keyword">new</code> <code class="plain">Regex(</code><code class="string">"[a-z0-9_\\-\\.]{1,20}@"</code> <code class="plain">+</code></span></span></div><div class="line alt1"><code class="number">3.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="string">"[a-z0-9_\\-]{1,20}.[a-z]{2,4}"</code><code class="plain">, RegexOptions.IgnoreCase);</code></span></span></div><div class="line alt2"><code class="number">4.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt1"><code class="number">5.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">foreach</code> <code class="plain">(Match match </code><code class="keyword">in</code> <code class="plain">regex.Matches(content))</code></span></span></div><div class="line alt2"><code class="number">6.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">{</code></span></span></div><div class="line alt1"><code class="number">7.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">Console.WriteLine(match.Value);</code></span></span></div><div class="line alt2"><code class="number">8.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">}</code></span></span></div></div></div>
<p><strong>3. Работа с DOM</strong></p>
<p>HTML-страница состоит из различных элементов, которые могут иметь свои аргументы и могут быть вложены в другие элементы, представляя некую иерархию. Поэтому не всегда выше указанные варианты парсинга могут помочь, либо придётся написать много мудрёного кода, чтобы получить нужный результат. В этом случае лучше всего работать с <a href="http://ru.wikipedia.org/wiki/Document_Object_Model" title="DOM" target="_blank">DOM</a> HTML-страницы.</p>
<p>Для работы с DOM HTML-страницы я использую библиотеку <a href="http://htmlagilitypack.codeplex.com/" title="Html Agility Pack" target="_blank">Html Agility Pack</a>, которая отлично справляется со своей задачей. Также, для парсинга будут использоваться очень удобные <a href="http://msdn.microsoft.com/ru-ru/library/ms256471(v=vs.90).aspx" title="XPath-выражения" target="_blank">XPath-выражения</a>.</p>
<p>Начнём с простого примера, который парсит все ссылки на HTML-странице:</p>
<div class="syntaxhighlighter " id="highlighter_521067" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">01.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">var doc = </code><code class="keyword">new</code> <code class="plain">HtmlDocument();</code></span></span></div><div class="line alt2"><code class="number">02.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">doc.LoadHtml(</code><code class="string">"..."</code><code class="plain">);</code></span></span></div><div class="line alt1"><code class="number">03.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt2"><code class="number">04.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="comments">// Используем XPath-выражение, чтобы выбрать все элементы с тегом 'a'.</code></span></span></div><div class="line alt1"><code class="number">05.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">var links = doc.DocumentNode.SelectNodes(</code><code class="string">".//a"</code><code class="plain">);</code></span></span></div><div class="line alt2"><code class="number">06.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt1"><code class="number">07.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">foreach</code> <code class="plain">(var link </code><code class="keyword">in</code> <code class="plain">links)</code></span></span></div><div class="line alt2"><code class="number">08.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">{</code></span></span></div><div class="line alt1"><code class="number">09.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="comments">// Получаем значение атрибута 'href' текущего элемента 'а'.</code></span></span></div><div class="line alt2"><code class="number">10.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">Console.WriteLine(link.Attributes[</code><code class="string">"href"</code><code class="plain">].Value);</code></span></span></div><div class="line alt1"><code class="number">11.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">}</code></span></span></div></div></div>
<p>А теперь получим данные из следующей HTML-страницы:</p>
<div class="syntaxhighlighter " id="highlighter_916604" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">01.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">&lt;</code><code class="keyword">div</code> <code class="color1">id</code><code class="plain">=</code><code class="string">"data"</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">02.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">&lt;</code><code class="keyword">table</code> <code class="color1">class</code><code class="plain">=</code><code class="string">"users-info"</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">03.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">&lt;</code><code class="keyword">thead</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">04.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 108px !important;"><code class="plain">&lt;</code><code class="keyword">tr</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">05.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">th</code><code class="plain">&gt;Имя&lt;/</code><code class="keyword">th</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">06.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">th</code><code class="plain">&gt;Возвраст&lt;/</code><code class="keyword">th</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">07.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">th</code><code class="plain">&gt;Профессия&lt;/</code><code class="keyword">th</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">08.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 108px !important;"><code class="plain">&lt;/</code><code class="keyword">tr</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">09.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">&lt;/</code><code class="keyword">thead</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">10.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">&lt;</code><code class="keyword">tbody</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">11.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 108px !important;"><code class="plain">&lt;</code><code class="keyword">tr</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">12.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">td</code><code class="plain">&gt;Иван&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">13.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">td</code><code class="plain">&gt;27&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">14.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">td</code><code class="plain">&gt;Сварщик&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">15.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 108px !important;"><code class="plain">&lt;/</code><code class="keyword">tr</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">16.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 108px !important;"><code class="plain">&lt;</code><code class="keyword">tr</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">17.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">td</code><code class="plain">&gt;Андрей&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">18.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">td</code><code class="plain">&gt;24&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">19.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">td</code><code class="plain">&gt;Безработный&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">20.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 108px !important;"><code class="plain">&lt;/</code><code class="keyword">tr</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">21.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 108px !important;"><code class="plain">&lt;</code><code class="keyword">tr</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">22.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">td</code><code class="plain">&gt;Александр&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">23.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">td</code><code class="plain">&gt;33&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">24.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;</code><code class="keyword">td</code><code class="plain">&gt;Водитель&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">25.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px !important;"><code class="plain">&lt;/</code><code class="keyword">tr</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">26.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">&lt;/</code><code class="keyword">tbody</code><code class="plain">&gt;</code></span></span></div><div class="line alt1"><code class="number">27.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">&lt;/</code><code class="keyword">table</code><code class="plain">&gt;</code></span></span></div><div class="line alt2"><code class="number">28.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">&lt;/</code><code class="keyword">div</code><code class="plain">&gt;</code></span></span></div></div></div>
<p>Код парсинга:</p>
<div class="syntaxhighlighter " id="highlighter_995579" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">01.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">var doc = </code><code class="keyword">new</code> <code class="plain">HtmlDocument();</code></span></span></div><div class="line alt2"><code class="number">02.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">doc.LoadHtml(</code><code class="string">"..."</code><code class="plain">);</code></span></span></div><div class="line alt1"><code class="number">03.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt2"><code class="number">04.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="comments">// div &gt; table &gt; tbody</code></span></span></div><div class="line alt1"><code class="number">05.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">var data = doc.GetElementbyId(</code><code class="string">"data"</code><code class="plain">).SelectSingleNode(</code><code class="string">"//table/tbody"</code><code class="plain">);</code></span></span></div><div class="line alt2"><code class="number">06.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt1"><code class="number">07.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="comments">// Выбираем все элементы с тегом 'tr'.</code></span></span></div><div class="line alt2"><code class="number">08.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">foreach</code> <code class="plain">(var usersInfo </code><code class="keyword">in</code> <code class="plain">data.ChildNodes.Where(n =&gt; n.Name == </code><code class="string">"tr"</code><code class="plain">))</code></span></span></div><div class="line alt1"><code class="number">09.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">{</code></span></span></div><div class="line alt2"><code class="number">10.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="comments">// Выбираем все элементы с тегом 'td'.</code></span></span></div><div class="line alt1"><code class="number">11.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">var userInfo = usersInfo.ChildNodes.</code></span></span></div><div class="line alt2"><code class="number">12.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">Where(n =&gt; n.Name == </code><code class="string">"td"</code><code class="plain">).ToArray();</code></span></span></div><div class="line alt1"><code class="number">13.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt2"><code class="number">14.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="comments">// Получаем значения элементов с тегом 'td'.</code></span></span></div><div class="line alt1"><code class="number">15.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">Console.WriteLine(</code><code class="string">"Имя: {0}"</code><code class="plain">,</code></span></span></div><div class="line alt2"><code class="number">16.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">userInfo[0].FirstChild.InnerText);</code></span></span></div><div class="line alt1"><code class="number">17.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">Console.WriteLine(</code><code class="string">"Возвраст: {0}"</code><code class="plain">,</code></span></span></div><div class="line alt2"><code class="number">18.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">userInfo[1].FirstChild.InnerText);</code></span></span></div><div class="line alt1"><code class="number">19.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">Console.WriteLine(</code><code class="string">"Профессия: {0}"</code><code class="plain">,</code></span></span></div><div class="line alt2"><code class="number">20.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">userInfo[2].FirstChild.InnerText);</code></span></span></div><div class="line alt1"><code class="number">21.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">}</code></span></span></div></div></div>
<p>Чтобы данную библиотеку было удобней использовать, можно написать расширяющий метод:</p>
<div class="syntaxhighlighter " id="highlighter_158752" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">01.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">public</code> <code class="keyword">static</code> <code class="keyword">class</code> <code class="plain">HttpResponseHelper</code></span></span></div><div class="line alt2"><code class="number">02.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">{</code></span></span></div><div class="line alt1"><code class="number">03.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="keyword">public</code> <code class="keyword">static</code> <code class="plain">HtmlDocument ToHtml(</code><code class="keyword">this</code> <code class="plain">HttpResponse response)</code></span></span></div><div class="line alt2"><code class="number">04.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">{</code></span></span></div><div class="line alt1"><code class="number">05.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="keyword">string</code> <code class="plain">content = response.ToText();</code></span></span></div><div class="line alt2"><code class="number">06.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt1"><code class="number">07.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">var document = </code><code class="keyword">new</code> <code class="plain">HtmlDocument();</code></span></span></div><div class="line alt2"><code class="number">08.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">document.LoadHtml(content);</code></span></span></div><div class="line alt1"><code class="number">09.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt2"><code class="number">10.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="keyword">return</code> <code class="plain">document;</code></span></span></div><div class="line alt1"><code class="number">11.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">}</code></span></span></div><div class="line alt2"><code class="number">12.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">}</code></span></span></div></div></div>
<p>Пример использования:</p>
<div class="syntaxhighlighter " id="highlighter_45696" style=""><div class="bar"><div class="toolbar"><a href="http://blog.epicsoft.ru/?p=34#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="http://blog.epicsoft.ru/?p=34#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="http://blog.epicsoft.ru/?p=34#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">01.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="keyword">using</code> <code class="plain">(var request = </code><code class="keyword">new</code> <code class="plain">HttpRequest())</code></span></span></div><div class="line alt2"><code class="number">02.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">{</code></span></span></div><div class="line alt1"><code class="number">03.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">var html = request.Get(</code><code class="string">"epicsoft.ru"</code><code class="plain">).ToHtml();</code></span></span></div><div class="line alt2"><code class="number">04.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt1"><code class="number">05.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="keyword">string</code> <code class="plain">title = html.DocumentNode.</code></span></span></div><div class="line alt2"><code class="number">06.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 72px !important;"><code class="plain">SelectSingleNode(</code><code class="string">"//title"</code><code class="plain">).InnerText;</code></span></span></div><div class="line alt1"><code class="number">07.</code><span class="content"><span class="block" style="margin-left: 0px !important;">&nbsp;</span></span></div><div class="line alt2"><code class="number">08.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 36px !important;"><code class="plain">Console.WriteLine(title);</code></span></span></div><div class="line alt1"><code class="number">09.</code><span class="content"><span class="block" style="margin-left: 0px !important;"><code class="plain">}</code></span></span></div></div></div>
<p><strong>Вывод</strong></p>
<ol>
<li>Отличный способ для парсинга простых данных, когда мы заранее знаем их расположение, да и к тому же данный способ потребляет минимум ресурсов, в отличие от других способов.</li>
<li>Незаменимый способ, когда нам нужно извлечь данные на основе неких условий. Также, регулярные выражения подходят для парсинга HTML-элементов, но тут могут возникнуть различные проблемы из-за их состава, особенно если нужно работать с иерархией таких элементов.</li>
<li>Самый лучший способ для парсинга HTML-страниц. Имейте ввиду, такие парсеры загружают в память всю DOM структуру страницы, поэтому при работе с большим количеством страниц может быть затрачено много памяти. Хотя, необязательно загружать всю страницу, можно извлечь и использовать только необходимую часть.</li>
</ol>
<p><strong>Ссылки на материалы по теме</strong></p>
<ul>
<li><a href="http://ru.wikipedia.org/wiki/HTML" title="HTML" target="_blank">HTML</a></li>
<li><a href="http://ru.wikipedia.org/wiki/Document_Object_Model" title="DOM" target="_blank">DOM</a></li>
<li><a href="http://msdn.microsoft.com/ru-ru/library/hs600312.aspx" title="Регулярные выражения" target="_blank">Регулярные выражения</a></li>
<li><a href="http://msdn.microsoft.com/ru-ru/library/ms256471(v=vs.90).aspx" title="XPath-выражения" target="_blank">XPath-выражения</a></li>
<li><a href="http://msdn.microsoft.com/ru-ru/library/182eeyhh.aspx" title="Введение в XML-сериализацию" target="_blank">Введение в XML-сериализацию</a></li>
<li><a href="http://james.newtonking.com/pages/json-net.aspx" title="Json.NET" target="_blank">Json.NET — библиотека для парсинга JSON данных</a></li>
<li><a href="http://htmlagilitypack.codeplex.com/" title="Html Agility Pack" target="_blank">Html Agility Pack — библиотека для парсинга HTML страниц</a></li>
</ul>
</div>

<div class="record-info">
<div class="autor-date">
    <p>Автор: X-rus <span class="edit"></span></p>
    <p>31 Янв 2012 в 10:15</p>
</div>	
<div class="tags">
    <p>Рубрика: <a href="http://blog.epicsoft.ru/?cat=9" title="Просмотреть все записи в рубрике «C#»" rel="category">C#</a>,<a href="http://blog.epicsoft.ru/?cat=5" title="Просмотреть все записи в рубрике «xNet»" rel="category">xNet</a></p>
    <p>Метки: <a href="http://blog.epicsoft.ru/?tag=net" rel="tag">.NET</a>, <a href="http://blog.epicsoft.ru/?tag=c" rel="tag">C#</a>, <a href="http://blog.epicsoft.ru/?tag=xnet" rel="tag">xNet</a>, <a href="http://blog.epicsoft.ru/?tag=%d0%bf%d0%b0%d1%80%d1%81%d0%b8%d0%bd%d0%b3" rel="tag">Парсинг</a></p></div>
</div>

<script type="text/javascript">
	function ins_quote(nick, comment_id)
	{
		var text = '';
		var area = $('textarea')[0];
		
		if (area.value.length > 0)
			text += '\n';
			
		text += '[url=#' + comment_id + ']@' + nick + '[/url]\n';
		
		if (document.getSelection &&
			document.getSelection().toString().length > 0)
		{	
			text += '[quote]' + document.getSelection().toString() + '[/quote]';
		}
		
		area.value += text;
		area.focus();
	}
	
	function ins_tag(tag_start, tag_end)
	{
		var area = $('textarea')[0];
		
		area.focus();
		
		if (document.getSelection)
		{
			var startIndex = area.selectionStart;
			var selection = area.value.substring(area.selectionStart, area.selectionEnd);
			
			area.value=area.value.substring(0, area.selectionStart) + tag_start + selection + tag_end+
				area.value.substring(area.selectionEnd, area.value.length);

			area.selectionStart = startIndex + tag_start.length;
			area.selectionEnd = area.selectionStart + selection.length;
		}

		area.focus();
	}
	
	function ins_tag_link()
	{
		var area = $('textarea')[0];
		
		area.focus();
		
		if (document.getSelection)
		{
			var startIndex = area.selectionStart;
			var selection = area.value.substring(area.selectionStart, area.selectionEnd);
			
			if (area.selectionStart != area.selectionEnd)
			{
				area.value=area.value.substring(0, area.selectionStart) + '[url='+ selection+ ']'+
					selection + '[/url]' + area.value.substring(area.selectionEnd, area.value.length);
					
				area.selectionStart = startIndex + 6 + selection.length;
			}
			else
			{
				area.value=area.value.substring(0, area.selectionStart) + '[url]'+
					selection + '[/url]' + area.value.substring(area.selectionEnd, area.value.length);
					
				area.selectionStart = startIndex + 5 + selection.length;
			}
				
			area.selectionEnd = area.selectionStart + selection.length;;
		}

		area.focus();
	}
	
	function ins_tag_list(tag_start, tag_end)
	{
		var area = $('textarea')[0];
		
		area.focus();
		
		if (document.getSelection)
		{
			var list = tag_start + '\n[li]значение 1[/li]\n[li]значение 2[/li]\n[li]значение 3[/li]\n' + tag_end;
			area.selectionEnd = area.selectionStart;
			
			area.value=area.value.substring(0, area.selectionStart) + list +
				area.value.substring(area.selectionEnd, area.value.length);
		}

		area.focus();
	}
</script>

<!-- You can start editing here. -->


 
<!-- If comments are open, but there are no comments. -->




<h3 class="your-comment">Ваш комментарий</h3>


<form action="http://blog.epicsoft.ru/wp-comments-post.php" method="post" name="commentform" id="commentform">
<div class="postinput">
<p><input type="text" name="author" id="author" value="" size="22" tabindex="1">
<label for="author"><small>Имя *</small></label></p>

<p><input type="text" name="email" id="email" value="" size="22" tabindex="2">
<label for="email"><small>Почта (не публикуется) *</small></label></p>

<p><input type="text" name="url" id="url" value="" size="22" tabindex="3">
<label for="url"><small>Сайт</small></label></p>


<div title="Жирный текст" class="bb bb-bold" onclick="ins_tag(&#39;[b]&#39;,&#39;[/b]&#39;)">B</div><div title="Наклонный текст" class="bb bb-italic" onclick="ins_tag(&#39;[i]&#39;,&#39;[/i]&#39;)">i</div><div title="Зачёркнутый текст" class="bb bb-striked" onclick="ins_tag(&#39;[s]&#39;,&#39;[/s]&#39;)">S</div><div title="Ссылка. Можно выделить ссылку и написать свой текст." class="bb bb-link" onclick="ins_tag_link()">link</div><div title="Внешнее изображение. Можно выделить URL на изображение." class="bb" onclick="ins_tag(&#39;[img]&#39;,&#39;[/img]&#39;)">img</div><div title="Код. По умолчанию ЯП - C#. Можно установить другой." class="bb" onclick="ins_tag(&#39;[code=\&#39;c#\&#39;]&#39;,&#39;[/code]&#39;)">code</div><div title="Маркированный список" class="bb" onclick="ins_tag_list(&#39;[ul]&#39;,&#39;[/ul]&#39;)">ul</div><div title="Нумерованный  список" class="bb" onclick="ins_tag_list(&#39;[ol]&#39;,&#39;[/ol]&#39;)">ol</div>
<p><textarea style="width: 714px" name="b5173-comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea><textarea name="comment" style="display:none" rows="1" cols="1"></textarea></p>

<p><input name="submit" type="submit" id="submit" tabindex="5" value="Отправить" title="Пожалуйста, проверьте комментарий перед отправкой">
<input type="hidden" name="comment_post_ID" value="34">
</p>
</div>
</form>




<div class="navigation group">
	<div class="alignleft"></div>
	<div class="alignright"></div>
</div>

</div> 

<!--menu-wrap-->
<div id="menu-wrap">
	<!--menu-->
	<div id="menu">
		<h3>Архивы</h3>		<ul>
			<li><a href="http://blog.epicsoft.ru/?m=201202" title="Февраль 2012">Февраль 2012</a></li>
	<li><a href="http://blog.epicsoft.ru/?m=201201" title="Январь 2012">Январь 2012</a></li>
		</ul>
<h3>Рубрики</h3>		<ul>
	<li class="cat-item cat-item-9"><a href="http://blog.epicsoft.ru/?cat=9" title="Просмотреть все записи в рубрике «C#»">C#</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://blog.epicsoft.ru/?cat=5" title="Просмотреть все записи в рубрике «xNet»">xNet</a>
</li>
	<li class="cat-item cat-item-14"><a href="http://blog.epicsoft.ru/?cat=14" title="Просмотреть все записи в рубрике «Вконтакте»">Вконтакте</a>
</li>
	<li class="cat-item cat-item-16"><a href="http://blog.epicsoft.ru/?cat=16" title="Просмотреть все записи в рубрике «Программы»">Программы</a>
</li>
		</ul>
<h3>Ссылки</h3>
	<ul class="xoxo blogroll">
<li><a href="http://epicsoft.ru/" title="Главная страничка сайта" target="_blank">EpicSoft.ru</a></li>
<li><a href="http://epicsoft.ru/Blog/?feed=rss2" title="Подпишитесь на RSS-ленту этого сайта" target="_blank">RSS записей</a></li>
<li><a href="http://epicsoft.ru/Blog/?feed=comments-rss2" title="Последние комментарии ко всем записям в RSS" target="_blank">RSS комментариев</a></li>
<li><a href="http://epicsoft.ru/xNet" title="Библиотека классов для .NET Framework" target="_blank">xNet</a></li>

	</ul>

<h3>Метки</h3><div class="tagcloud"><a href="http://blog.epicsoft.ru/?tag=net" class="tag-link-4" title="6 записей" style="font-size: 22pt;">.NET</a>
<a href="http://blog.epicsoft.ru/?tag=c" class="tag-link-3" title="6 записей" style="font-size: 22pt;">C#</a>
<a href="http://blog.epicsoft.ru/?tag=http" class="tag-link-6" title="1 запись" style="font-size: 8pt;">HTTP</a>
<a href="http://blog.epicsoft.ru/?tag=vasan" class="tag-link-15" title="2 записи" style="font-size: 12.581818181818pt;">Vasan</a>
<a href="http://blog.epicsoft.ru/?tag=vkontakte-api" class="tag-link-13" title="2 записи" style="font-size: 12.581818181818pt;">Vkontakte api</a>
<a href="http://blog.epicsoft.ru/?tag=web" class="tag-link-7" title="1 запись" style="font-size: 8pt;">Web</a>
<a href="http://blog.epicsoft.ru/?tag=wpf" class="tag-link-17" title="1 запись" style="font-size: 8pt;">Wpf</a>
<a href="http://blog.epicsoft.ru/?tag=xnet" class="tag-link-5" title="5 записей" style="font-size: 20.218181818182pt;">xNet</a>
<a href="http://blog.epicsoft.ru/?tag=%d0%bc%d0%bd%d0%be%d0%b3%d0%be%d0%bf%d0%be%d1%82%d0%be%d1%87%d0%bd%d0%be%d1%81%d1%82%d1%8c" class="tag-link-10" title="1 запись" style="font-size: 8pt;">Многопоточность</a>
<a href="http://blog.epicsoft.ru/?tag=%d0%b2%d0%ba%d0%be%d0%bd%d1%82%d0%b0%d0%ba%d1%82%d0%b5-api" class="tag-link-12" title="2 записи" style="font-size: 12.581818181818pt;">Вконтакте API</a>
<a href="http://blog.epicsoft.ru/?tag=%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b8" class="tag-link-18" title="1 запись" style="font-size: 8pt;">Настройки</a>
<a href="http://blog.epicsoft.ru/?tag=%d0%bf%d0%b0%d1%80%d1%81%d0%b8%d0%bd%d0%b3" class="tag-link-11" title="1 запись" style="font-size: 8pt;">Парсинг</a>
<a href="http://blog.epicsoft.ru/?tag=%d1%81%d0%b5%d1%82%d1%8c" class="tag-link-8" title="1 запись" style="font-size: 8pt;">Сеть</a></div>
	</div>
	<!--/menu-->
</div>
<!--/menu-wrap-->

        <!--copyright-->
        <div id="copyright">
            <p id="text">
                Designed by X-rus, 2011-2012 © <a href="http://epicsoft.ru/">EpicSoft</a></p>
        </div>
        <!--/copyright-->

<!-- SyntaxHighlighter Stuff -->
<script type="text/javascript" src="./Парсинг данных_files/shCore.js"></script>
	<script type="text/javascript" src="./Парсинг данных_files/shBrushCSharp.js"></script>
	<!-- Reassign aliases -->
	<script type="text/javascript">
				SyntaxHighlighter.brushes.CSharp.aliases = ["c#", "c-sharp", "csharp"];
	</script>
	<script type="text/javascript" src="./Парсинг данных_files/shBrushXml.js"></script>
	<!-- Reassign aliases -->
	<script type="text/javascript">
				SyntaxHighlighter.brushes.Xml.aliases = ["xml", "html", "xhtml", "xslt"];
	</script>
<script type="text/javascript">
	SyntaxHighlighter.all();
</script>

    </div>
    <!--/main-->

</body></html>